# üë®üèª‚Äçüíª **User Service**

### –°–µ—Ä–≤–∏—Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏

- **ADMIN:** –ø—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞/—Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ª—é–±–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- **USER:** —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è, –≤—Ö–æ–¥, –ø—Ä–æ—Å–º–æ—Ç—Ä —Å–≤–æ–µ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è –ø–æ ID, –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Å–µ–±—è

---

## ‚öôÔ∏è **–°—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π**

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç       | –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏                   |
|-----------------|------------------------------|
| Backend         | TypeScript, Node.js, Express |
| ORM             | Prisma 6+                    |
| Database        | PostgreSQL                   |
| Auth            | JWT (jsonwebtoken)           |
| Dev Environment | Docker Compose               |

---

## üóÇÔ∏è **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞**

```
src/
 ‚îú‚îÄ modules/
 ‚îÇ   ‚îî‚îÄ user/
 ‚îÇ      ‚îú‚îÄ user.controller.ts    ‚Äî –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã REST
 ‚îÇ      ‚îú‚îÄ user.service.ts       ‚Äî –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
 ‚îÇ      ‚îú‚îÄ user.repository.ts    ‚Äî —Ä–∞–±–æ—Ç–∞ —Å –ë–î —á–µ—Ä–µ–∑ Prisma
 ‚îÇ      ‚îî‚îÄ user.routes.ts        ‚Äî –º–∞—Ä—à—Ä—É—Ç—ã    
 ‚îú‚îÄ middleware/
 ‚îÇ   ‚îî‚îÄ auth.middleware.ts       ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ JWT
 ‚îú‚îÄ database/
 ‚îÇ   ‚îî‚îÄ prisma.ts                ‚Äî –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è PrismaClient
 ‚îú‚îÄ types/
 ‚îÇ   ‚îú‚îÄ express/
 ‚îÇ   ‚îÇ  ‚îî‚îÄ index.d.ts            ‚Äî —Ç–∏–ø–∏–∑–∞—Ü–∏—è JWT-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
 ‚îÇ   ‚îî‚îÄ role.enum.ts             ‚Äî –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏–µ —Ä–æ–ª–µ–π
 ‚îú‚îÄ utils/
 ‚îÇ   ‚îú‚îÄ jwt.ts                   ‚Äî –≥–µ–Ω–µ—Ä–∞—Ü–∏—è/–ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–æ–≤
 ‚îÇ   ‚îî‚îÄ hash.ts                  ‚Äî —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π
 ‚îî‚îÄ server.ts                    ‚Äî —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ (Express)
```

---

## üöÄ **–°—Ç–∞—Ä—Ç**

### 1Ô∏è‚É£ –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

#### - üíª Node.js 20+

#### - üì¶ npm

#### - üê≥ Docker Desktop (–¥–ª—è PostgreSQL)

#### - üíª IDE (VSCode, WebStorm)

---

### 2Ô∏è‚É£ –ü–æ–¥–Ω—è—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö (PostgreSQL)

–í –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞:

```bash
docker compose up -d
```

> –ü—Ä–∏–º–µ—Ä `docker-compose.yml`:

```yaml
services:
  db:
    image: postgres:latest
    command: [ "postgres", "-c", "port=5433" ]
    environment:
      POSTGRES_DB: users
      POSTGRES_USER: postgres
      POSTGRES_PASSWORD: 123
    ports:
      - "5433:5433"
    volumes:
      - users_pg:/var/lib/postgresql/data
volumes:
  users_pg:
```

---

### 3Ô∏è‚É£ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

–í –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ —É–∂–µ –µ—Å—Ç—å `.env` –∫–∞–∫ –ø—Ä–∏–º–µ—Ä:

```
DATABASE_URL="postgresql://postgres:123@localhost:5433/users?schema=public"
JWT_SECRET="supersecretkey"
```

---

### 4Ô∏è‚É£ –ú–∏–≥—Ä–∞—Ü–∏–∏ Prisma (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)

–ü–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ –∏ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –∏—Ö:

```bash
# –°–æ–∑–¥–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é
npx prisma migrate dev --name init

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –±–∞–∑—ã
npx prisma migrate status
```

> **Prisma** –º–∏–≥—Ä–∞—Ü–∏–∏ —Å–æ–∑–¥–∞—é—Ç —Ç–∞–±–ª–∏—Ü—ã –∏ —Å—Ö–µ–º—ã, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å–µ—Ä–≤–∏—Å–∞.

> ‚ö†Ô∏è –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ **Docker Desktop** –ø–æ—è–≤–∏–ª—Å—è –∏ –≤–∫–ª—é—á–µ–Ω –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä users.
---

### 5Ô∏è‚É£ –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
npm install

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è Prisma Client
npx prisma generate

# –ó–∞–ø—É—Å–∫ dev-—Å–µ—Ä–≤–µ—Ä–∞
npx ts-node src/server.ts
```

üìç –°–µ—Ä–≤–µ—Ä –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É: [http://localhost:3000](http://localhost:3000)

---

## üìù **–ü—Ä–∏–º–µ—Ä—ã REST API**

### 1Ô∏è‚É£ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

```
POST /api/users/register
Content-Type: application/json

{
  "fullName": "–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤",
  "email": "ivan@example.com",
  "password": "123456",
  "birthDate": "1999-05-12"
}
```

### 2Ô∏è‚É£ –õ–æ–≥–∏–Ω

```
POST /api/users/login
Content-Type: application/json

{
  "email": "ivan@example.com",
  "password": "123456"
}
```

- –û—Ç–≤–µ—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç JWT —Ç–æ–∫–µ–Ω:

```json
{
  "accessToken": "<JWT_TOKEN>"
}
```

### 3Ô∏è‚É£ –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ ID

```
GET /api/users/1
Authorization: Bearer <JWT_TOKEN>
```

- –î–æ—Å—Ç—É–ø–Ω–æ: –∞–¥–º–∏–Ω –∏–ª–∏ —Å–∞–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å.

### 4Ô∏è‚É£ –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∞)

```
GET /api/users/
Authorization: Bearer <ADMIN_JWT_TOKEN>
```

### 5Ô∏è‚É£ –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

```
PATCH /api/users/block/<id>
Authorization: Bearer <JWT_TOKEN>
```

- –ê–¥–º–∏–Ω –º–æ–∂–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –ª—é–±–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è 
- –û–±—ã—á–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ —Å–µ–±—è

### 6Ô∏è‚É£ –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

```
PATCH /api/users/unblock/<id>
Authorization: Bearer <JWT_TOKEN>
```

- –õ–æ–≥–∏–∫–∞ —Ç–∞ –∂–µ: –∞–¥–º–∏–Ω ‚Äî –ª—é–±–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ç–æ–ª—å–∫–æ —Å–µ–±—è

---

## ‚õÉ **–ü—Ä–∏–º–µ—á–∞–Ω–∏—è –ø–æ –ë–î (Prisma + PostgreSQL)**

- –ú–æ–¥–µ–ª—å User (Prisma):

```prisma
model User {
  id        Int      @id @default(autoincrement())
  fullName  String   
  email     String   @unique
  password  String   
  birthDate DateTime 
  role      Role     
  isActive  Boolean  @default(true)
}

enum Role {
  ADMIN
  USER
}
```

- Prisma Client –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ `src/database/prisma.ts`:

```ts
import {PrismaClient} from "@prisma/client";

export const prisma = new PrismaClient();
```

- –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ PostgreSQL.

---

## üåê **HTTP Client**

**–°—Ü–µ–Ω–∞—Ä–∏–∏**:

- **–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è**
- **–õ–æ–≥–∏–Ω –∏ –ø–æ–ª—É—á–µ–Ω–∏–µ JWT**
- **–ü—Ä–æ—Å–º–æ—Ç—Ä —Å–≤–æ–µ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è / —Å–ø–∏—Å–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–∞–¥–º–∏–Ω)**
- **–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ / —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è**

